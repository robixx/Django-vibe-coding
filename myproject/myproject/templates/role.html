{% extends "base.html" %}

{% block title %}Role Management - TailAdmin{% endblock %}

{% block extra_css %}
<style>
    .action-btns {
        display: flex;
        gap: 8px;
    }
    
    .btn-action {
        padding: 6px 10px;
        border-radius: 4px;
        font-size: 12px;
        cursor: pointer;
        border: none;
        transition: all 0.2s;
    }
    
    .btn-edit {
        background: #DBEAFE;
        color: #2563EB;
    }
    
    .btn-edit:hover {
        background: #BFDBFE;
    }
    
    .btn-delete {
        background: #FEE2E2;
        color: #DC2626;
    }
    
    .btn-delete:hover {
        background: #FECACA;
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <h1><i class="fas fa-user-shield"></i> Role Management</h1>
    <p>Manage user roles and permissions</p>
</div>

<!-- Role List -->
<div class="content-card">
    <div class="card-header">
        <div class="card-title">
            <i class="fas fa-list"></i> All Roles
        </div>
        <div class="card-actions">
            <form method="GET" action="{% url 'role' %}" style="display: flex; gap: 8px;">
                <div class="table-search">
                    <input type="text" name="search" id="tableSearch" placeholder="Search..." value="{{ search_query }}">
                    <i class="fas fa-search"></i>
                </div>
                <button type="submit" class="btn btn-secondary">
                    <i class="fas fa-search"></i>
                </button>
            </form>
            <a href="{% url 'role_add' %}" class="btn btn-primary">
                <i class="fas fa-plus"></i> Add Role
            </a>
        </div>
    </div>
    
    <div class="card-body">
        <table class="data-table" id="roleTable">
            <thead>
                <tr>
                    <th>SL No</th>
                    <th>Role Name</th>
                    <th>Description</th>
                    <th>Status</th>
                    <th>Created At</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for role in roles %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td><strong>{{ role.role_name }}</strong></td>
                    <td>{{ role.role_description|default:"-" }}</td>
                    <td>
                        <span class="status-badge {% if role.is_active %}success{% else %}danger{% endif %}">
                            {% if role.is_active %}<i class="fas fa-check-circle"></i> Active{% else %}<i class="fas fa-times-circle"></i> Inactive{% endif %}
                        </span>
                    </td>
                    <td>{{ role.created_at|date:"Y-m-d H:i" }}</td>
                    <td>
                        <div class="action-btns">
                            <a href="{% url 'role_edit' role.id %}" class="btn-action btn-edit">
                                <i class="fas fa-edit"></i> Edit
                            </a>
                            <a href="{% url 'role_delete' role.id %}" class="btn-action btn-delete" onclick="return confirm('Are you sure you want to delete this role?')">
                                <i class="fas fa-trash"></i> Delete
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center py-4">No roles found. <a href="{% url 'role_add' %}">Add a new role</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- Pagination -->
    <div class="pagination">
        <div class="pagination-info">
            Showing {{ roles.start_index }} to {{ roles.end_index }} of {{ roles.paginator.count }} entries
        </div>
        <div class="pagination-buttons">
            {% if roles.has_previous %}
            <a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}" class="page-btn"><i class="fas fa-angle-double-left"></i></a>
            <a href="?page={{ roles.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-btn"><i class="fas fa-angle-left"></i></a>
            {% else %}
            <span class="page-btn disabled"><i class="fas fa-angle-double-left"></i></span>
            <span class="page-btn disabled"><i class="fas fa-angle-left"></i></span>
            {% endif %}
            
            {% for num in page_range %}
            <a href="?page={{ num }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-btn {% if num == roles.number %}active{% endif %}">{{ num }}</a>
            {% endfor %}
            
            {% if roles.has_next %}
            <a href="?page={{ roles.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-btn"><i class="fas fa-angle-right"></i></a>
            <a href="?page={{ roles.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-btn"><i class="fas fa-angle-double-right"></i></a>
            {% else %}
            <span class="page-btn disabled"><i class="fas fa-angle-right"></i></span>
            <span class="page-btn disabled"><i class="fas fa-angle-double-right"></i></span>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
