{% comment %} Reusable Pagination Template {% endcomment %}
{% if paginator.num_pages > 1 %}
<div class="pagination-container">
    <div class="pagination-info">
        <span class="pagination-stats">
            Showing <strong>{{ page_obj.start_index }}</strong> to <strong>{{ page_obj.end_index }}</strong> of <strong>{{ paginator.count }}</strong> entries
        </span>
        
        <div style="display: flex; align-items: center; gap: 8px; margin-left: 20px;">
            <label for="per_page">Show:</label>
            <select id="per_page" onchange="changePerPage(this.value)">
                <option value="10" {% if items_per_page == 10 %}selected{% endif %}>10</option>
                <option value="25" {% if items_per_page == 25 %}selected{% endif %}>25</option>
                <option value="50" {% if items_per_page == 50 %}selected{% endif %}>50</option>
                <option value="100" {% if items_per_page == 100 %}selected{% endif %}>100</option>
            </select>
        </div>
        
        <div class="jump-to-page">
            <span>Go to:</span>
            <input type="number" id="jump_page" min="1" max="{{ paginator.num_pages }}">
            <button onclick="jumpToPage()">Go</button>
        </div>
    </div>
    
    <div class="pagination-wrapper">
        {% comment %} First Page {% endcomment %}
        {% if page_obj.has_previous %}
        <a href="?page=1&per_page={{ items_per_page }}" class="pagination-btn" title="First Page">
            <i class="fas fa-angle-double-left"></i>
        </a>
        {% else %}
        <span class="pagination-btn disabled" title="First Page">
            <i class="fas fa-angle-double-left"></i>
        </span>
        {% endif %}
        
        {% comment %} Previous Page {% endcomment %}
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}&per_page={{ items_per_page }}" class="pagination-btn" title="Previous Page">
            <i class="fas fa-angle-left"></i>
        </a>
        {% else %}
        <span class="pagination-btn disabled" title="Previous Page">
            <i class="fas fa-angle-left"></i>
        </span>
        {% endif %}
        
        {% comment %} Page Numbers {% endcomment %}
        {% for num in page_range %}
            {% if num == page_obj.number %}
            <span class="pagination-btn active">{{ num }}</span>
            {% elif num > 0 %}
            <a href="?page={{ num }}&per_page={{ items_per_page }}" class="pagination-btn">{{ num }}</a>
            {% endif %}
        {% endfor %}
        
        {% comment %} Next Page {% endcomment %}
        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}&per_page={{ items_per_page }}" class="pagination-btn" title="Next Page">
            <i class="fas fa-angle-right"></i>
        </a>
        {% else %}
        <span class="pagination-btn disabled" title="Next Page">
            <i class="fas fa-angle-right"></i>
        </span>
        {% endif %}
        
        {% comment %} Last Page {% endcomment %}
        {% if page_obj.has_next %}
        <a href="?page={{ paginator.num_pages }}&per_page={{ items_per_page }}" class="pagination-btn" title="Last Page">
            <i class="fas fa-angle-double-right"></i>
        </a>
        {% else %}
        <span class="pagination-btn disabled" title="Last Page">
            <i class="fas fa-angle-double-right"></i>
        </span>
        {% endif %}
    </div>
</div>
{% endif %}

<script>
    function changePerPage(value) {
        const url = new URL(window.location.href);
        url.searchParams.set('per_page', value);
        url.searchParams.set('page', 1);
        window.location.href = url.toString();
    }
    
    function jumpToPage() {
        const page = document.getElementById('jump_page').value;
        const maxPage = {{ paginator.num_pages }};
        
        if (page && page >= 1 && page <= maxPage) {
            const url = new URL(window.location.href);
            url.searchParams.set('page', page);
            window.location.href = url.toString();
        } else {
            alert('Please enter a valid page number (1-' + maxPage + ')');
        }
    }
    
    document.getElementById('jump_page').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            jumpToPage();
        }
    });
</script>
