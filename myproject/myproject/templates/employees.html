{% extends "base.html" %}

{% block title %}Employees - TailAdmin{% endblock %}

{% block extra_css %}
<style>
    /* Override CSS Variables for TailAdmin Style */
    :root {
        --primary: #3B82F6;
        --primary-hover: #2563EB;
        --primary-light: #DBEAFE;
        --success: #10B981;
        --success-light: #D1FAE5;
        --warning: #F59E0B;
        --warning-light: #FEF3C7;
        --danger: #EF4444;
        --danger-light: #FEE2E2;
        --purple: #8B5CF6;
        --purple-light: #EDE9FE;
        --light-bg: #F3F4F6;
        --white: #FFFFFF;
        --text-primary: #1F2937;
        --text-secondary: #6B7280;
        --text-link: #3B82F6;
        --border: #E5E7EB;
        --border-light: #F3F4F6;
        --header-bg: #FFFFFF;
        --sidebar-bg: #111827;
        --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
        --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    /* Pagination Styles */
    .pagination-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 24px;
        background: white;
        border-top: 1px solid #E5E7EB;
        flex-wrap: wrap;
        gap: 16px;
    }
    
    .pagination-info {
        display: flex;
        align-items: center;
        gap: 12px;
        color: #6B7280;
        font-size: 14px;
    }
    
    .pagination-info select {
        padding: 5px 15px;
        border: 1px solid #E5E7EB;
        border-radius: 6px;
        font-size: 12px;
        outline: none;
        cursor: pointer;
        background: white;
        color: #1F2937;
        transition: all 0.2s;
    }
    
    .pagination-info select:hover {
        border-color: #3B82F6;
    }
    
    .pagination-stats {
        font-size: 11px;
        color: #6B7280;
    }
    
    .pagination-stats strong {
        color: #1F2937;
    }
    
    /* Pagination Buttons */
    .pagination-wrapper {
        display: flex;
        align-items: center;
        gap: 4px;
    }
    
    .pagination-btn {
        min-width: 25px;
        height: 25px;
        padding: 0 5px;
        border: 1px solid #E5E7EB;
        border-radius: 5px;
        background: white;
        color: #6B7280;
        font-size: 11px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
    }
    
    .pagination-btn:hover:not(.disabled):not(.active) {
        border-color: #3B82F6;
        color: #3B82F6;
    }
    
    .pagination-btn.active {
        background: #3B82F6;
        border-color: #3B82F6;
        color: white;
        font-weight: 600;
    }
    
    .pagination-btn.disabled {
        opacity: 0.4;
        cursor: not-allowed;
    }
    
    /* Jump to page */
    .jump-to-page {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-left: 16px;
        padding-left: 16px;
        border-left: 1px solid #E5E7EB;
    }
    
    .jump-to-page input {
        width: 60px;
        padding: 5px 15px;
        border: 1px solid #E5E7EB;
        border-radius: 6px;
        font-size: 12px;
        text-align: center;
        outline: none;
    }
    
    .jump-to-page input:focus {
        border-color: #3B82F6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .jump-to-page button {
        padding: 5px 15px;
        background: #3B82F6;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .jump-to-page button:hover {
        background: #2563EB;
    }
    
    /* Filter Pills */
    .filter-pill {
        padding: 4px 10px;
        border-radius: 3px;
        font-size: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.15s ease;
        border: 1px solid transparent;
        background: #F3F4F6;
        color: #6B7280;
    }
    
    .filter-pill:hover {
        background: #E5E7EB;
        color: #1F2937;
    }
    
    .filter-pill.active {
        background: #3B82F6;
        color: white;
    }
    
    /* Table Search */
    .table-search {
        position: relative;
    }
    
    .table-search input {
        width: 180px;
        padding: 6px 12px 6px 30px;
        border: 1px solid #E5E7EB;
        border-radius: 6px;
        font-size: 12px;
        background: #F9FAFB;
        color: #1F2937;
        transition: all 0.2s;
    }
    
    .table-search input:focus {
        outline: none;
        border-color: #3B82F6;
        background: white;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .table-search i {
        position: absolute;
        left: 10px;
        top: 50%;
        transform: translateY(-50%);
        color: #9CA3AF;
        font-size: 12px;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
        .pagination-container {
            flex-direction: column;
            align-items: stretch;
        }
        
        .pagination-info {
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .pagination-wrapper {
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .jump-to-page {
            display: none;
        }
        
        .filter-bar {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .filter-left {
            flex-wrap: wrap;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <h1><i class="fas fa-users"></i> Employees</h1>
    <p>Manage all employee records and information</p>
</div>

<!-- Filter Bar -->
<div class="content-card mb-6">
    <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 16px; padding: 5px 13px;">
        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <span class="filter-pill active">All ({{ employees.paginator.count }})</span>
            <span class="filter-pill">Active</span>
            <span class="filter-pill">Inactive</span>
            <span class="filter-pill">New Hires</span>
        </div>
        <div style="display: flex; gap: 8px;">
            <button class="btn btn-secondary btn-sm">
                <i class="fas fa-filter"></i> Filter
            </button>
            <button class="btn btn-primary btn-sm">
                <i class="fas fa-plus"></i> Add Employee
            </button>
        </div>
    </div>
</div>

<!-- Employees Table -->
<div class="content-card">
    <div class="card-header">
        <div class="card-title">
            <i class="fas fa-user-tie"></i>
            Employee List
        </div>
        <div class="card-actions">
            <div class="table-search">
                <input type="text" id="tableSearch" placeholder="Search..." onkeyup="searchTable()">
                <i class="fas fa-search"></i>
            </div>
            <span style="background: #F3F4F6; padding: 6px 12px; border-radius: 3px; font-size: 13px; font-weight: 600; cursor:pointer; color: #6B7280;">
                {{ employees.paginator.count }} employees
            </span>
        </div>
    </div>
    <div class="card-body" style="padding: 0;">
        <table class="data-table">
            <thead>
                <tr>
                    <th>SL No</th>
                    <th>Employee ID</th>
                    <th>Name</th>
                    <th>Designation</th>
                    <th>Address</th>
                    <th>Mobile</th>
                    <th>Email</th>
                </tr>
            </thead>
            <tbody>
                {% for employee in employees %}
                <tr>
                    <td>{{ employee.slno }}</td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 25px; height: 25px; border-radius: 5px; background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 11px;">
                                {{ employee.employeeid|upper|slice:":2" }}
                            </div>
                            <span style="font-weight: 500;">{{ employee.employeeid }}</span>
                        </div>
                    </td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 25px; height: 25px; border-radius: 50%; background: linear-gradient(135deg, #10B981 0%, #059669 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 12px;">
                                {{ employee.nameemployee|upper|slice:":1" }}
                            </div>
                            <span style="font-weight: 500;">{{ employee.nameemployee }}</span>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge success">
                            <i class="fas fa-check"></i>
                            {{ employee.designation }}
                        </span>
                    </td>
                    <td style="color: #6B7280;">{{ employee.presentaddress }}</td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 8px; color: #6B7280;">
                            <i class="fas fa-phone" style="font-size: 12px;"></i>
                            {{ employee.mobilenumber }}
                        </div>
                    </td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 8px; color: #6B7280;">
                            <i class="fas fa-envelope" style="font-size: 12px;"></i>
                            {{ employee.localguardianemail }}
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7">
                        <div class="empty-state">
                            <i class="fas fa-users"></i>
                            <h3>No employees found</h3>
                            <p>Add your first employee to get started</p>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- Pagination -->
    {% if employees.paginator.num_pages > 1 %}
    <div class="pagination-container">
        <div class="pagination-info">
            <span class="pagination-stats">
                Showing <strong>{{ employees.start_index }}</strong> to <strong>{{ employees.end_index }}</strong> of <strong>{{ employees.paginator.count }}</strong> entries
            </span>
            
            <div style="display: flex; align-items: center; gap: 8px; margin-left: 20px;">
                <label for="per_page" style="font-size: 13px; color: #6B7280;">Show:</label>
                <select id="per_page" onchange="changePerPage(this.value)">
                    <option value="10" {% if items_per_page == 10 %}selected{% endif %}>10</option>
                    <option value="25" {% if items_per_page == 25 %}selected{% endif %}>25</option>
                    <option value="50" {% if items_per_page == 50 %}selected{% endif %}>50</option>
                    <option value="100" {% if items_per_page == 100 %}selected{% endif %}>100</option>
                </select>
            </div>
            
            <div class="jump-to-page">
                <span style="font-size: 13px; color: #6B7280;">Go to:</span>
                <input type="number" id="jump_page" min="1" max="{{ employees.paginator.num_pages }}">
                <button onclick="jumpToPage()">Go</button>
            </div>
        </div>
        
        <div class="pagination-wrapper">
            <!-- First Page -->
            {% if employees.has_previous %}
            <a href="?page=1&per_page={{ items_per_page }}" class="pagination-btn" title="First Page">
                <i class="fas fa-angle-double-left"></i>
            </a>
            {% else %}
            <span class="pagination-btn disabled" title="First Page">
                <i class="fas fa-angle-double-left"></i>
            </span>
            {% endif %}
            
            <!-- Previous Page -->
            {% if employees.has_previous %}
            <a href="?page={{ employees.previous_page_number }}&per_page={{ items_per_page }}" class="pagination-btn" title="Previous Page">
                <i class="fas fa-angle-left"></i>
            </a>
            {% else %}
            <span class="pagination-btn disabled" title="Previous Page">
                <i class="fas fa-angle-left"></i>
            </span>
            {% endif %}
            
            <!-- Page Numbers -->
            {% for num in page_range %}
                {% if num == employees.number %}
                <span class="pagination-btn active">{{ num }}</span>
                {% elif num > 0 %}
                <a href="?page={{ num }}&per_page={{ items_per_page }}" class="pagination-btn">{{ num }}</a>
                {% endif %}
            {% endfor %}
            
            <!-- Next Page -->
            {% if employees.has_next %}
            <a href="?page={{ employees.next_page_number }}&per_page={{ items_per_page }}" class="pagination-btn" title="Next Page">
                <i class="fas fa-angle-right"></i>
            </a>
            {% else %}
            <span class="pagination-btn disabled" title="Next Page">
                <i class="fas fa-angle-right"></i>
            </span>
            {% endif %}
            
            <!-- Last Page -->
            {% if employees.has_next %}
            <a href="?page={{ employees.paginator.num_pages }}&per_page={{ items_per_page }}" class="pagination-btn" title="Last Page">
                <i class="fas fa-angle-double-right"></i>
            </a>
            {% else %}
            <span class="pagination-btn disabled" title="Last Page">
                <i class="fas fa-angle-double-right"></i>
            </span>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>

<script>
    function searchTable() {
        // Get input value
        const input = document.getElementById('tableSearch');
        const filter = input.value.toLowerCase();
        
        // Get table and rows
        const table = document.querySelector('.data-table');
        const tbody = table.querySelector('tbody');
        const rows = tbody.querySelectorAll('tr');
        
        // Loop through all table rows
        rows.forEach(row => {
            // Get all cells in the row
            const cells = row.querySelectorAll('td');
            let found = false;
            
            // Search in each cell
            cells.forEach(cell => {
                const text = cell.textContent || cell.innerText;
                if (text.toLowerCase().indexOf(filter) > -1) {
                    found = true;
                }
            });
            
            // Show/hide row
            if (found) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }
    
    function changePerPage(value) {
        const url = new URL(window.location.href);
        url.searchParams.set('per_page', value);
        url.searchParams.set('page', 1);
        window.location.href = url.toString();
    }
    
    function jumpToPage() {
        const page = document.getElementById('jump_page').value;
        const maxPage = {{ employees.paginator.num_pages }};
        
        if (page && page >= 1 && page <= maxPage) {
            const url = new URL(window.location.href);
            url.searchParams.set('page', page);
            window.location.href = url.toString();
        } else {
            alert('Please enter a valid page number (1-' + maxPage + ')');
        }
    }
    
    document.getElementById('jump_page').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            jumpToPage();
        }
    });
</script>
{% endblock %}
